{% extends 'base.html' %}
{% load i18n %}

{% block content %}

    <main>
        <!-- Hero Section -->
        {% if header %}
            <section class="page-hero" {% if header.photo %}style="background-image:url('{{ header.photo.url }}')" {% endif %}>
                <div class="container">
                    <h1>{{ header.title }}</h1>
                    {% if header.description %}
                        <p>{{ header.description }}</p>
                    {% endif %}
                </div>
            </section>
        {% endif %}

        <!-- Contacts Content -->
        <section class="contacts-section">
            <div class="container">
                <div class="contacts-grid">
                    <div class="contact-info">
                        <h2>{% trans '–ù–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã' %}</h2>
                        
                        <div class="contact-details">
                            <div class="contact-item">
                                <div class="contact-icon">üìç</div>
                                <div class="contact-text">
                                    <h3>{% trans '–ê–¥—Ä–µ—Å' %}</h3>
                                    {% for a in addresses %}
                                        <p>
                                            {% if a.title %} <b>{{ a.title }} :</b>{% endif %}
                                            {% if a.city %}{{ a.city }}, {% endif %}
                                            {{ a.address|linebreaksbr }}
                                        </p>
                                    {% endfor %}
                                </div>
                            </div>

                            <div class="contact-item">
                                <div class="contact-icon">üìû</div>
                                <div class="contact-text">
                                    <h3>{% trans '–¢–µ–ª–µ—Ñ–æ–Ω' %}</h3>
                                    {% if phones %}
                                    <p>
                                        {% for p in phones %}
                                            {% if p.label %}{{ p.label }}: {% endif %}<a href="tel:{{ p.phone }}">{{ p.phone }}</a>{% if not forloop.last %}<br>{% endif %}
                                        {% endfor %}
                                    </p>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="contact-item">
                                <div class="contact-icon">‚úâÔ∏è</div>
                                <div class="contact-text">
                                    <h3>{% trans 'Email' %}</h3>
                                    {% if emails %}
                                    <p>
                                        {% for e in emails %}
                                            {% if e.label %}{{ e.label }}: {% endif %}<a href="mailto:{{ e.email }}">{{ e.email }}</a>{% if not forloop.last %}<br>{% endif %}
                                        {% endfor %}
                                    </p>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="contact-item">
                                <div class="contact-icon">üïí</div>
                                <div class="contact-text">
                                    <h3>{% trans '–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã' %}</h3>
                                    {% if hours %}
                                    <p>
                                        {{ hours.weekdays }}<br>
                                        {{ hours.saturday }}<br>
                                        {{ hours.sunday }}{% if hours.note %}<br>{{ hours.note }}{% endif %}
                                    </p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Form -->
                    <div class="contact-form">
                        <h2>{% trans '–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É' %}</h2>
                        <p>{% trans '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É, –∏ –º—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è' %}</p>
                        
                        <form id="contactForm" method="post" {% if form_success %}style="display: none;"{% endif %}>
                            {% csrf_token %}
                            {% if form_errors %}
                                <div style="color: #d9534f; margin-bottom: 16px;">
                                    {% for error in form_errors %}
                                        <p style="margin: 0;">{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="form-group">
                                <label for="name">{% trans '–í–∞—à–µ –∏–º—è *' %}</label>
                                <input type="text" id="name" name="name" required value="{{ form_data.name|default_if_none:'' }}">
                            </div>

                            <div class="form-group">
                                <label for="phone">{% trans '–¢–µ–ª–µ—Ñ–æ–Ω *' %}</label>
                                <input type="tel" id="phone" name="phone" required placeholder="{% trans '+7 (___) ___-__-__' %}" value="{{ form_data.phone|default_if_none:'' }}">
                            </div>

                            <div class="form-group">
                                <label for="email">{% trans 'Email' %}</label>
                                <input type="email" id="email" name="email" placeholder="{% trans 'example@email.com' %}" value="{{ form_data.email|default_if_none:'' }}">
                            </div>

                            <div class="form-group">
                                <label for="subject">{% trans '–¢–µ–º–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è' %}</label>
                                <select id="subject" name="topic">
                                    {% for t in topics %}
                                        <option value="{{ t.slug }}" {% if form_data.topic == t.slug %}selected{% endif %}>{{ t.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="message">{% trans '–°–æ–æ–±—â–µ–Ω–∏–µ *' %}</label>
                                <textarea id="message" name="message" rows="5" required placeholder="{% trans '–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ, —á—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç‚Ä¶' %}">{{ form_data.message|default_if_none:'' }}</textarea>
                            </div>

                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="consent" value="1" required {% if form_data.consent %}checked{% endif %}>
                                    <span class="checkmark"></span>
                                    {% trans '–°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö *' %}
                                </label>
                            </div>

                            <button type="submit" class="btn btn-primary">{% trans '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É' %}</button>
                        </form>

                        <div class="form-success" id="formSuccess" {% if not form_success %}style="display: none;"{% endif %}>
                            <h3>{% trans '–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ!' %}</h3>
                            <p>{% trans '–í–∞—à–∞ –∑–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.' %}</p>
                        </div>
                    </div>
                </div>

                <!-- Map Section -->
                <div class="map-section">
                    <h2>{% trans '–ö–∞–∫ –Ω–∞—Å –Ω–∞–π—Ç–∏' %}</h2>
                    <div class="map-container">
                        {% with s=footer_social|default_if_none:social %}
                            {% if s and s.map_embed %}
                                {{ s.map_embed|safe }}
                            {% elif s and s.map_url %}
                                <iframe
                                    src="{{ s.map_url }}"
                                    width="100%"
                                    height="400"
                                    style="border:0;"
                                    allowfullscreen=""
                                    loading="lazy"
                                    referrerpolicy="no-referrer-when-downgrade">
                                </iframe>
                            {% endif %}
                        {% endwith %}
                    </div>
                </div>
            </div>
        </section>
    </main>

{% endblock %}